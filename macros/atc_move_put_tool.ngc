; Macro to safely put down a tool based on preposition
; parameter: active_pocket

o<atc_move_put_tool> sub  
o100 if [EXISTS[#<_ini[ATC_TOOL_SAFE_DISTANCE]X>]]
    ; first move X
    G53 G01 X[#<_ini[ATC_FIRST_POCKET]X> + [#1 -1] * #<_ini[ATC_TOOL_SLOT_DELTA]X>] F#<_ini[ATC_MISC]DROPSPEEDXY>
    ; second move Y
    G53 G01 Y[#<_ini[ATC_FIRST_POCKET]Y> + [#1 -1] * #<_ini[ATC_TOOL_SLOT_DELTA]Y>] F#<_ini[ATC_MISC]DROPSPEEDXY>
    ; third move Z partially rapid
    G53 G00 Z #<_ini[ATC_TOOL_SAFE_DISTANCE]Z 
    G53 G01 Z #<_ini[ATC_FIRST_POCKET]Z F#<_ini[ATC_MISC]DROPSPEEDZ>
    o100 endif
o<atc_move_put_tool> endsub  
M2